% Font
\usepackage[utf8]{inputenc} 
\usepackage{mlmodern}
\usepackage[T1]{fontenc}
% Uncomment for sans
% \renewcommand*\familydefault{\sfdefault}

% Packages
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage[x11names]{xcolor}
\usepackage{mathrsfs}
\usepackage[shortlabels]{enumitem}
\usepackage{mathtools}
\usepackage{microtype}
\usepackage[paper=a4paper,margin=25mm]{geometry}
\usepackage{framed}
\usepackage[amsmath, thmmarks, framed]{ntheorem}
\usepackage{tikz}
\usetikzlibrary{angles, calc, math, through}
\usepackage{polski}
\usepackage{array}
\usepackage{float}
\usepackage{caption}
\usepackage{setspace}
\usepackage{tabto}
\usepackage{titlesec}
\usepackage{listings}
\usepackage{tocloft}
\usepackage{lastpage}
\usepackage{fancyhdr} 
\usepackage{cancel}
\usepackage{pdfpages}
\usepackage{transparent}
\usepackage{xifthen}
\usepackage{import}
\usepackage{printlen}
\usepackage{parskip}
\usepackage{lipsum}
\usepackage{siunitx}
\usepackage{booktabs}
\usepackage{cite}
\usepackage{matlab-prettifier}
\usepackage[noEnd=true,indLines=false,spaceRequire=false,rightComments=false,beginComment=//~,beginLComment=//~,endLComment=]{algpseudocodex}
\usepackage[most]{tcolorbox}
\usepackage[final, colorlinks=true, linkcolor=black, citecolor=black, urlcolor=darkgray]{hyperref} 
\usepackage{cleveref}

% Inkscape figures
\newcommand{\incfig}[1]{%
    \import{./figures/}{#1.pdf_tex}
}
\pdfsuppresswarningpagegroup=1

% Lengths
\setstretch{1.15}
\setlength\parindent{0pt}

% http://tex.stackexchange.com/questions/22119/how-can-i-change-the-spacing-before-theorems-with-amsthm
\makeatletter
\def\thm@space@setup{%
  \thm@preskip=\parskip \thm@postskip=0pt
}
\makeatother

% Periods after section numbers
\renewcommand{\cftsecleader}{\cftdotfill{\cftdotsep}}
\renewcommand{\cftpartaftersnum}{.}
\renewcommand{\cftsecaftersnum}{.}
\renewcommand{\cftsubsecaftersnum}{.}

% Cleveref fix
\crefname{equation}{}{}
\crefname{theorem}{}{}
\crefname{lemma}{}{}
\crefname{example}{}{}
\crefname{definition}{}{}
\crefname{figure}{}{}
\crefname{table}{}{}
\crefname{listing}{}{}
\crefname{lstlisting}{}{}
\crefname{lstinputlisting}{}{}

% Title and titlepage
\titlelabel{\thetitle.\quad}

\makeatletter
\newcommand{\printcover}{
    \begin{titlepage}
        \begin{center}
            \IfFileExists{logo\_mini.png}{\includegraphics[width=0.75\textwidth]{logo_mini.png}}{\hphantom{}}
            \vspace{0.1\textheight}
            \\\Huge \textsf{\@title}
            \@ifundefined{subtitle}{}{\\\Large \subtitle}
            \@ifundefined{flavortext}{}{\\\large \flavortext}
            \vspace{0.25\textheight}
            \\\Large \textsf{\textbf{\@author}}
            \@ifundefined{placedate}{}{\\\large \placedate}
        \end{center}
    \end{titlepage}
}
\makeatother

% Common math symbols and operators
\providecommand{\ol}{\overline}
\providecommand{\oa}{\overrightarrow}
\providecommand{\ul}{\underline}
\providecommand{\tl}{\widetilde}

\providecommand{\NN}{\mathbb{N}}
\providecommand{\ZZ}{\mathbb{Z}}
\providecommand{\QQ}{\mathbb{Q}}
\providecommand{\RR}{\mathbb{R}}
\providecommand{\CC}{\mathbb{C}}
\providecommand{\KK}{\mathbb{K}}
\providecommand{\BB}{\mathcal{B}}
\providecommand{\CC}{\mathcal{C}}
\providecommand{\LL}{\mathcal{L}}
\providecommand{\EE}{\mathcal{E}}
\providecommand{\PP}{\mathcal{P}}
\providecommand{\UU}{\mathcal{U}}
\providecommand{\VV}{\mathcal{V}}
\providecommand{\ii}{\mathrm{i}}
\providecommand{\ee}{\mathrm{e}}
\providecommand{\dd}{\,\mathrm{d}}
\providecommand{\cont}{\mathfrak{c}}

\DeclareMathOperator{\arctg}{arctg}
\DeclareMathOperator{\arcctg}{arcctg}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\proj}{proj}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\Id}{Id}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\rd}{rd}
\DeclareMathOperator{\fl}{fl}
\DeclareMathOperator{\af}{af}
\DeclareMathOperator{\spann}{span}
\let\Im\relax
\DeclareMathOperator{\Im}{Im}
\let\Re\relax
\DeclareMathOperator{\Re}{Re}
\DeclareMathSymbol{\hyph}{\mathord}{AMSa}{"39}

\renewcommand{\vec}[1]{\boldsymbol{\mathbf{#1}}}
\renewcommand{\AA}{\mathcal{A}}

\DeclarePairedDelimiter\abs{\lvert}{\rvert}
\DeclarePairedDelimiter\norm{\lVert}{\rVert}

\makeatletter
\renewcommand*\env@matrix[1][*\c@MaxMatrixCols c]{%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{#1}}
\makeatother

% Column type for math-mode tables
\newcolumntype{C}{>{\(}c<{\)}}

% enumerating (a), (b), ...
\setlist[enumerate,1]{label={(\alph*)}}

% Footer and header
\pagestyle{fancy} 
\pagenumbering{arabic}
\fancyfoot[L]{} 
\fancyfoot[C]{\thepage}
\fancyfoot[R]{} 

\fancyhead[L]{}
\fancyhead[R]{}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}

\colorlet{codebkgcolor}{white}
\colorlet{codecommentcolor}{Snow4}
\colorlet{codekeywordcolor}{LightSkyBlue4}
\colorlet{codenumbercolor}{Thistle4}
\colorlet{codestringcolor}{PeachPuff4}

% Code listings
\lstdefinestyle{codestyle}{
    commentstyle=\itshape\color{codecommentcolor},
    keywordstyle=\color{codekeywordcolor},
    numberstyle=\color{codenumbercolor},
    stringstyle=\color{codestringcolor},
    basicstyle=\small\ttfamily,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=none,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=4,
}
\lstset{
    style=codestyle,
    escapeinside={\%*}{*)},
    extendedchars=false,
    inputencoding=utf8,
    backgroundcolor=\color{codebkgcolor},
    frame=single,
    literate={á}{{\'a}}1 {é}{{\'e}}1 {í}{{\'i}}1 {ó}{{\'o}}1 {ú}{{\'u}}1
    {Á}{{\'A}}1 {É}{{\'E}}1 {Í}{{\'I}}1 {Ó}{{\'O}}1 {Ú}{{\'U}}1
    {à}{{\`a}}1 {è}{{\`e}}1 {ì}{{\`i}}1 {ò}{{\`o}}1 {ù}{{\`u}}1
    {À}{{\`A}}1 {È}{{\'E}}1 {Ì}{{\`I}}1 {Ò}{{\`O}}1 {Ù}{{\`U}}1
    {ä}{{\"a}}1 {ë}{{\"e}}1 {ï}{{\"i}}1 {ö}{{\"o}}1 {ü}{{\"u}}1
    {Ä}{{\"A}}1 {Ë}{{\"E}}1 {Ï}{{\"I}}1 {Ö}{{\"O}}1 {Ü}{{\"U}}1
    {â}{{\^a}}1 {ê}{{\^e}}1 {î}{{\^i}}1 {ô}{{\^o}}1 {û}{{\^u}}1
    {Â}{{\^A}}1 {Ê}{{\^E}}1 {Î}{{\^I}}1 {Ô}{{\^O}}1 {Û}{{\^U}}1
    {œ}{{\oe}}1 {Œ}{{\OE}}1 {æ}{{\ae}}1 {Æ}{{\AE}}1 {ß}{{\ss}}1
    {ç}{{\c c}}1 {Ç}{{\c C}}1 {ø}{{\o}}1 {å}{{\r a}}1 {Å}{{\r A}}1
    {€}{{\EUR}}1 {£}{{\pounds}}1
    {ą}{{\k a}}1 {Ą}{{\k A}}1 {ć}{{\' c}}1 {Ć}{{\' C}}1 {ę}{{\k e}}1
    {Ę}{{\k E}}1 {ł}{{\l}}1 {Ł}{{\L}}1 {ń}{{\' n}}1 {Ń}{{\' N}}1
    {ś}{{\' s}}1 {Ś}{{\' S}}1 {ż}{{\. z}}1 {Ż}{{\. Z}}1
    {ź}{{\' z}}1 {Ź}{{\' Z}}1
}

% Theorem-like environments
\makeatletter
\renewtheoremstyle{break}%
    {\item[\rlap{\vbox{\hbox{\hskip\labelsep \theorem@headerfont
##1\ ##2\theorem@separator}\hbox{\strut}}}]}%
    {\item[\rlap{\vbox{\hbox{\hskip\labelsep \theorem@headerfont
##1\ ##2\theorem@separator \mdseries\ (##3)}\hbox{\strut}}}]}
\renewtheoremstyle{plain}%
  {\item[\hskip\labelsep \theorem@headerfont ##1\ ##2\theorem@separator]}%
{\item[\hskip\labelsep \theorem@headerfont ##1\ ##2\theorem@separator\  \mdseries(##3)]}
\renewtheoremstyle{nonumberplain}%
  {\item[\theorem@headerfont\hskip\labelsep ##1\theorem@separator]}%
{\item[\hskip\labelsep \theorem@headerfont ##1\ \mdseries(##3)\theorem@separator]}
\makeatother

\theoremstyle{break}
\theoremheaderfont{\bfseries}
\theorembodyfont{\mdseries}
\theoremsymbol{}
\theoremseparator{.}
\newtheorem{theorem}{Twierdzenie}[section]

\theoremstyle{break}
\theoremheaderfont{\bfseries}
\theorembodyfont{\mdseries}
\theoremsymbol{}
\theoremseparator{.}
\newtheorem{lemma}[theorem]{Lemat}

\theoremstyle{break}
\theoremheaderfont{\bfseries}
\theorembodyfont{\mdseries}
\theoremsymbol{}
\theoremseparator{.}
\newtheorem{corollary}[theorem]{Wniosek}

\theoremstyle{break}
\theoremheaderfont{\bfseries}
\theorembodyfont{\mdseries}
\theoremsymbol{}
\theoremseparator{.}
\newtheorem{definition}[theorem]{Definicja}

\theoremstyle{break}
\theoremheaderfont{\bfseries}
\theorembodyfont{\mdseries}
\theoremsymbol{}
\theoremseparator{.}
\newtheorem{example}[theorem]{Przykład}

\theoremstyle{break}
\theoremheaderfont{\bfseries}
\theorembodyfont{\mdseries}
\theoremsymbol{}
\theoremseparator{.}
\newtheorem{algorithm}[theorem]{Algorytm}

\theoremstyle{nonumberplain}
\theoremheaderfont{\bfseries}
\theorembodyfont{\mdseries}
\theoremsymbol{}
\theoremseparator{:}
\newtheorem{remark}{Uwaga}

% \vspace{-\belowdisplayskip}\[\] - put this hack at the end of proof if the end-of-proof square isn't placed correctly 
\theoremstyle{nonumberplain}
\theoremheaderfont{\bfseries}
\theorembodyfont{\mdseries}
\theoremsymbol{\ensuremath\square}
\theoremseparator{:}
\newtheorem{proof}{Dowód}
